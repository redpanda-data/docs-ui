<div class="home-header-container">
  <div class="navbar">
    <img src="{{{uiRootPath}}}/img/home-logo.svg" width="auto" height="28px" alt="Redpanda logo"/>
    <div class="theme-switcher">
      <button id="switch-theme" type="button" title="Switch between dark and light mode" aria-label="Switch between dark and light mode" aria-live="polite"><img class="theme-image" src="{{{uiRootPath}}}/img/octicons-24.svg#view-sun" alt=""></img>
      </button>
    </div>
    <p>{{page.attributes.intro}}</p>
  </div>
  <div class="home-header">
    <iframe
      title="Kapa AI Widget"
      src="/ask-ai.html"
      style="height: 400px; width: 100%; border-radius: 0; border: none;"
    >
    </iframe>
    <div class="suggestion-chips">
      {{#each page.attributes.ai-suggestions}}
      <div class="chip">{{this}}</div>
      {{/each}}
    </div>
  </div>
</div>
<section class="features">
  <div class='container'>
    {{#each page.attributes.row}}
      {{#with this.title}}
        <h2>{{this}}</h2>
      {{/with}}
      <div class="feature-row">
        {{#each this.items}}
          {{#if (eq (array-length this.urls) 1)}}
            {{#each this.urls}}
              <a href="{{{relativize (resolvePageURL this.url)}}}" class="feature-link">
            {{/each}}
              <div class="feature-box">
                {{#if this.image}}
                <div class="feature-image">
                  <img src='./_images/{{this.image}}' alt={{{this.title}}} loading="lazy"/>
                </div>
                {{/if}}
                <div class="feature-text">
                  <h2 class="discrete feature-title">{{{this.title}}}</h2>
                  {{#if this.description}}
                    <p class="feature-description">{{{this.description}}}</p>
                  {{/if}}
                  {{#if this.learn-text}}
                    <p class="feature-learn-text">Learn more &rarr;</p>
                  {{/if}}
                </div>
              </div>
              </a>
          {{else}}
            <div class="feature-box">
              {{#if this.image}}
              <div class="feature-image">
                <img src='./_images/{{this.image}}' alt={{{this.title}}} loading="lazy"/>
              </div>
              {{/if}}
              <div class="feature-text">
                <h2 class="discrete feature-title">{{{this.title}}}</h2>
                {{#if this.description}}
                  <p class="feature-description">{{{this.description}}}</p>
                {{/if}}
                {{#if this.learn-text}}
                  <p class="feature-learn-text">Learn more &rarr;</p>
                {{/if}}
                <ul>
                  {{#each this.urls}}
                    <li><a href="{{{relativize (resolvePageURL this.url)}}}">{{this.text}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          {{/if}}
        {{/each}}
      </div>
    {{/each}}
  </div>
</section>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const iframe = document.querySelector('iframe');

  iframe.addEventListener('load', function () {
    const iframeDoc = iframe.contentWindow.document;

    const modalBody = iframeDoc.querySelector(".mantine-Modal-body > div:nth-child(3)");
    const modalHeader = iframeDoc.querySelector(".mantine-Modal-header");

    if (modalBody) {
      modalBody.style.display = "none";
    }

    if (modalHeader) {
      modalHeader.style.paddingLeft = "0";
    }
  });

  document.querySelectorAll('.suggestion-chips .chip').forEach(chip => {
    chip.addEventListener('click', () => {
      const text = chip.textContent.trim();
      iframe.contentWindow.Kapa.open({
        mode: "ai",
        query: text,
        submit: true,
      });
    });
  });
})
</script>
